#!/usr/bin/env python3
import os
import pandas as pd


# os.chdir('/Users/kika/ownCloud/archamoebae/orthofinder/')
# table = open('Orthogroups.tsv')

# og_dict = {}
# for line in table:
# 	og = line.split('\t')[0]
# 	acc = line.strip().split('\t')[1:]
# 	og_dict[og] = acc

# with open('Orthogroups_upd.tsv', 'w') as out:
# 	for key, value in og_dict.items():
# 		for i in value:
# 			out.write('{}\t{}\n'.format(key, i))


os.chdir('/Users/kika/ownCloud/blasto_comparative/count_software/all_Blastos_losses/')
table = pd.read_table('all_Blastos_losses.tsv')
headers = list(table.columns)[1:]
# headers = [item.replace('Ch. caulleryi', 'Chilomastixcau').replace('Ch. cuspidata', 'Chilomastixcus') for item in headers]
# print(headers)

# OGs = ['OG0000135', 'OG0000714', 'OG0005005', 'OG0006144', 'OG0006300', 'OG0006426', 'OG0006797', 'OG0006802', 'OG0006973', 'OG0006976', 'OG0007113', 'OG0007125', 'OG0007128', 'OG0007133', 'OG0007135', 'OG0007276', 'OG0007279', 'OG0007282', 'OG0007285', 'OG0007290', 'OG0007291', 'OG0007294', 'OG0007299', 'OG0007304', 'OG0007306', 'OG0007431', 'OG0007435', 'OG0007437', 'OG0007439', 'OG0007440', 'OG0007445', 'OG0007446', 'OG0007447', 'OG0007449', 'OG0007451', 'OG0007455', 'OG0007457', 'OG0007459', 'OG0007460', 'OG0007464', 'OG0007469', 'OG0007470', 'OG0007473', 'OG0007475', 'OG0007476', 'OG0007477', 'OG0007478', 'OG0007481', 'OG0007482', 'OG0007483', 'OG0007484', 'OG0007729', 'OG0007731', 'OG0007734', 'OG0007735', 'OG0007738', 'OG0007740', 'OG0007741', 'OG0007742', 'OG0007743', 'OG0007744', 'OG0007745', 'OG0007749', 'OG0007754', 'OG0007756', 'OG0007758', 'OG0007759', 'OG0007761', 'OG0007762', 'OG0007764', 'OG0007766', 'OG0007767', 'OG0007770', 'OG0007771', 'OG0007773', 'OG0007775', 'OG0007776', 'OG0007777', 'OG0007778', 'OG0007779', 'OG0007785', 'OG0007787', 'OG0007788', 'OG0007789', 'OG0007972', 'OG0007973', 'OG0007974', 'OG0007976', 'OG0007977', 'OG0007978', 'OG0007979', 'OG0007980', 'OG0007981', 'OG0007982', 'OG0007983', 'OG0007984', 'OG0007986', 'OG0007987', 'OG0007988', 'OG0007989', 'OG0007990', 'OG0007991', 'OG0007992', 'OG0007993', 'OG0007994', 'OG0007996', 'OG0007997', 'OG0007998', 'OG0007999', 'OG0008000', 'OG0008001', 'OG0008002', 'OG0008003', 'OG0008004', 'OG0008005', 'OG0008006', 'OG0008008', 'OG0008009', 'OG0008010', 'OG0008011', 'OG0008012', 'OG0008013', 'OG0008014', 'OG0008016', 'OG0008017', 'OG0008018', 'OG0008019', 'OG0008020', 'OG0008021', 'OG0008022', 'OG0008023', 'OG0008024', 'OG0008026', 'OG0008027', 'OG0008028', 'OG0008029', 'OG0008030', 'OG0008031', 'OG0008032', 'OG0008033', 'OG0008034', 'OG0008036', 'OG0008037', 'OG0008038', 'OG0008039', 'OG0008041', 'OG0008043', 'OG0008044', 'OG0008045', 'OG0008046', 'OG0008047', 'OG0008048', 'OG0008049', 'OG0008050', 'OG0008051', 'OG0008052', 'OG0008053', 'OG0008055', 'OG0008056', 'OG0008058', 'OG0008059', 'OG0008060', 'OG0008061', 'OG0008062', 'OG0008064', 'OG0008065', 'OG0008067', 'OG0008068', 'OG0008069', 'OG0008070', 'OG0008071', 'OG0008292', 'OG0008293', 'OG0008294', 'OG0008295', 'OG0008296', 'OG0008297', 'OG0008298', 'OG0008299', 'OG0008300', 'OG0008301', 'OG0008303', 'OG0008305', 'OG0008306', 'OG0008308', 'OG0008310', 'OG0008311', 'OG0008314', 'OG0008315', 'OG0008316', 'OG0008317', 'OG0008319', 'OG0008323', 'OG0008327', 'OG0008329', 'OG0008330', 'OG0008331', 'OG0008332', 'OG0008334', 'OG0008335', 'OG0008336', 'OG0008338', 'OG0008342']
OGs = ['OG0000018', 'OG0000154', 'OG0000222', 'OG0000223', 'OG0000243', 'OG0000315', 'OG0000352', 'OG0000421', 'OG0000489', 'OG0000518', 'OG0000558', 'OG0000601', 'OG0000723', 'OG0000816', 'OG0000817', 'OG0000818', 'OG0000957', 'OG0001213', 'OG0001629', 'OG0001630', 'OG0002397', 'OG0002398', 'OG0002399', 'OG0004542', 'OG0004543', 'OG0004544', 'OG0004545', 'OG0004546', 'OG0004547', 'OG0004548', 'OG0005154', 'OG0005155', 'OG0005156', 'OG0005157', 'OG0005158', 'OG0005496', 'OG0005497', 'OG0005498', 'OG0005499', 'OG0005500', 'OG0005501', 'OG0005502', 'OG0005503', 'OG0005504', 'OG0005505', 'OG0005506', 'OG0005507', 'OG0005508', 'OG0005509', 'OG0005510', 'OG0005705', 'OG0005706', 'OG0005707', 'OG0005708', 'OG0005709', 'OG0005710', 'OG0005711', 'OG0005712', 'OG0005713', 'OG0005714', 'OG0005715', 'OG0005716', 'OG0005717', 'OG0005718', 'OG0005719', 'OG0005720', 'OG0005721', 'OG0005722', 'OG0005723', 'OG0005724', 'OG0005725', 'OG0005726', 'OG0005727', 'OG0005728', 'OG0005729', 'OG0005730', 'OG0005731', 'OG0005732', 'OG0005733', 'OG0005734', 'OG0005735', 'OG0005736', 'OG0005737', 'OG0005738', 'OG0005739', 'OG0005740', 'OG0005741', 'OG0005742', 'OG0005891', 'OG0005892', 'OG0005893', 'OG0005894', 'OG0005895', 'OG0005896', 'OG0005897', 'OG0005898', 'OG0005899', 'OG0005900', 'OG0005901', 'OG0005902', 'OG0005903', 'OG0005904', 'OG0005905', 'OG0005906', 'OG0005907', 'OG0005908', 'OG0005909', 'OG0005910', 'OG0005911', 'OG0005912', 'OG0005913', 'OG0005914', 'OG0005915', 'OG0005916', 'OG0005917', 'OG0005918', 'OG0005919', 'OG0005920', 'OG0005921', 'OG0005922', 'OG0005923', 'OG0005924', 'OG0005925', 'OG0005926', 'OG0005927', 'OG0005928', 'OG0005929', 'OG0005930', 'OG0005931', 'OG0005932', 'OG0005933', 'OG0005934', 'OG0005935', 'OG0005936', 'OG0005937', 'OG0005938', 'OG0005939', 'OG0005940', 'OG0005941', 'OG0005942', 'OG0005943', 'OG0005944', 'OG0005945', 'OG0005946', 'OG0005947', 'OG0006034', 'OG0006035', 'OG0006036', 'OG0006037', 'OG0006038', 'OG0006039', 'OG0006040', 'OG0006041', 'OG0006042', 'OG0006043', 'OG0006044', 'OG0006045', 'OG0006046', 'OG0006047', 'OG0006048', 'OG0006049', 'OG0006050', 'OG0006051', 'OG0006052', 'OG0006053', 'OG0006054', 'OG0006055', 'OG0006056', 'OG0006057', 'OG0006058', 'OG0006059', 'OG0006060', 'OG0006061', 'OG0006062', 'OG0006063', 'OG0006064', 'OG0006065', 'OG0006066', 'OG0006067', 'OG0006068', 'OG0006069', 'OG0006070', 'OG0006071', 'OG0006072', 'OG0006073', 'OG0006074', 'OG0006075', 'OG0006076', 'OG0006077', 'OG0006078', 'OG0006079', 'OG0006080', 'OG0006081', 'OG0006082', 'OG0006083', 'OG0006084', 'OG0006085', 'OG0006086', 'OG0006087', 'OG0006088', 'OG0006089', 'OG0006090', 'OG0006091', 'OG0006092', 'OG0006093', 'OG0006094', 'OG0006095', 'OG0006175', 'OG0006176', 'OG0006177', 'OG0006178', 'OG0006179', 'OG0006180', 'OG0006181', 'OG0006182', 'OG0006183', 'OG0006184', 'OG0006185', 'OG0006186', 'OG0006187', 'OG0006188', 'OG0006189', 'OG0006190', 'OG0006191', 'OG0006192', 'OG0006193', 'OG0006194', 'OG0006195', 'OG0006196', 'OG0006197', 'OG0006198', 'OG0006199', 'OG0006200', 'OG0006201', 'OG0006202', 'OG0006203', 'OG0006204', 'OG0006205', 'OG0006206', 'OG0006207', 'OG0006208', 'OG0006209', 'OG0006210', 'OG0006211', 'OG0006212', 'OG0006213', 'OG0006214', 'OG0006215', 'OG0006216', 'OG0006217', 'OG0006218', 'OG0006219', 'OG0006220', 'OG0006221', 'OG0006222', 'OG0006223', 'OG0006224', 'OG0006225', 'OG0006226', 'OG0006227', 'OG0006228', 'OG0006229', 'OG0006230', 'OG0006231', 'OG0006232', 'OG0006233', 'OG0006234', 'OG0006235', 'OG0006236', 'OG0006237', 'OG0006238', 'OG0006239', 'OG0006240', 'OG0006241', 'OG0006242', 'OG0006243', 'OG0006244', 'OG0006245', 'OG0006246', 'OG0006247', 'OG0006248', 'OG0006249', 'OG0006250', 'OG0006251', 'OG0006252', 'OG0006253', 'OG0006254', 'OG0006321', 'OG0006322', 'OG0006323', 'OG0006324', 'OG0006325', 'OG0006326', 'OG0006327', 'OG0006328', 'OG0006329', 'OG0006330', 'OG0006331', 'OG0006332', 'OG0006333', 'OG0006334', 'OG0006335', 'OG0006336', 'OG0006337', 'OG0006338', 'OG0006339', 'OG0006340', 'OG0006341', 'OG0006342', 'OG0006343', 'OG0006344', 'OG0006345', 'OG0006346', 'OG0006347', 'OG0006348', 'OG0006349', 'OG0006350', 'OG0006351', 'OG0006352', 'OG0006353', 'OG0006354', 'OG0006355', 'OG0006356', 'OG0006357', 'OG0006358', 'OG0006359', 'OG0006360', 'OG0006361', 'OG0006362', 'OG0006363', 'OG0006364', 'OG0006365', 'OG0006366', 'OG0006367', 'OG0006368', 'OG0006369', 'OG0006370', 'OG0006371', 'OG0006372', 'OG0006373', 'OG0006374', 'OG0006375', 'OG0006376', 'OG0006377', 'OG0006378', 'OG0006379', 'OG0006380', 'OG0006381', 'OG0006382', 'OG0006456', 'OG0006457', 'OG0006458', 'OG0006459', 'OG0006460', 'OG0006461', 'OG0006462', 'OG0006463', 'OG0006464', 'OG0006465', 'OG0006466', 'OG0006467', 'OG0006468', 'OG0006469', 'OG0006470', 'OG0006471', 'OG0006472', 'OG0006473', 'OG0006474', 'OG0006475', 'OG0006476', 'OG0006477', 'OG0006478', 'OG0006479', 'OG0006480', 'OG0006481', 'OG0006482', 'OG0006483', 'OG0006484', 'OG0006485', 'OG0006486', 'OG0006487', 'OG0006488', 'OG0006489', 'OG0006490', 'OG0006491', 'OG0006492', 'OG0006493', 'OG0006494', 'OG0006495', 'OG0006496', 'OG0006497', 'OG0006498', 'OG0006499', 'OG0006500', 'OG0006501', 'OG0006502', 'OG0006503', 'OG0006504', 'OG0006505', 'OG0006506', 'OG0006507', 'OG0006508', 'OG0006509', 'OG0006510', 'OG0006511', 'OG0006512', 'OG0006513', 'OG0006514', 'OG0006515', 'OG0006516', 'OG0006517', 'OG0006518', 'OG0006519', 'OG0006520', 'OG0006521', 'OG0006522', 'OG0006523', 'OG0006524', 'OG0006525', 'OG0006526', 'OG0006527', 'OG0006528', 'OG0006529', 'OG0006530', 'OG0006531', 'OG0006532', 'OG0006533', 'OG0006534', 'OG0006535', 'OG0006536', 'OG0006537', 'OG0006642', 'OG0006643', 'OG0006644', 'OG0006645', 'OG0006646', 'OG0006647', 'OG0006648', 'OG0006649', 'OG0006650', 'OG0006651', 'OG0006652', 'OG0006653', 'OG0006654', 'OG0006655', 'OG0006656', 'OG0006657', 'OG0006658', 'OG0006659', 'OG0006660', 'OG0006661', 'OG0006662', 'OG0006663', 'OG0006664', 'OG0006665', 'OG0006666', 'OG0006667', 'OG0006668', 'OG0006669', 'OG0006670', 'OG0006671', 'OG0006672', 'OG0006673', 'OG0006674', 'OG0006675', 'OG0006676', 'OG0006677', 'OG0006678', 'OG0006679', 'OG0006680', 'OG0006681', 'OG0006682', 'OG0006683', 'OG0006684', 'OG0006685', 'OG0006686', 'OG0006687', 'OG0006688', 'OG0006689', 'OG0006690', 'OG0006819', 'OG0006820', 'OG0006821', 'OG0006822', 'OG0006823', 'OG0006824', 'OG0006825', 'OG0006826', 'OG0006827', 'OG0006828', 'OG0006829', 'OG0006830', 'OG0006831', 'OG0006832', 'OG0006833', 'OG0006834', 'OG0006835', 'OG0006836', 'OG0006837', 'OG0006838', 'OG0006839', 'OG0006840', 'OG0006841', 'OG0006842', 'OG0006843', 'OG0006844', 'OG0006845', 'OG0006846', 'OG0006847', 'OG0006849', 'OG0006850', 'OG0006851', 'OG0006852', 'OG0006853', 'OG0006989', 'OG0006990', 'OG0006991', 'OG0006992', 'OG0006993', 'OG0006994', 'OG0006995', 'OG0006996', 'OG0006997', 'OG0006999', 'OG0007000', 'OG0007001', 'OG0007002', 'OG0007003', 'OG0007004', 'OG0007005', 'OG0007006', 'OG0007007', 'OG0007008', 'OG0007009', 'OG0007010', 'OG0007011', 'OG0007012', 'OG0007013', 'OG0007014', 'OG0007015', 'OG0007016', 'OG0007017', 'OG0007018', 'OG0007019', 'OG0007020', 'OG0007021', 'OG0007022', 'OG0007023', 'OG0007024', 'OG0007025', 'OG0007026', 'OG0007155', 'OG0007156', 'OG0007157', 'OG0007158', 'OG0007159', 'OG0007160', 'OG0007161', 'OG0007162', 'OG0007163', 'OG0007164', 'OG0007165', 'OG0007166', 'OG0007167', 'OG0007168', 'OG0007169', 'OG0007170', 'OG0007171', 'OG0007172', 'OG0007173', 'OG0007174', 'OG0007175', 'OG0007176', 'OG0007177', 'OG0007178', 'OG0007179', 'OG0007180', 'OG0007315', 'OG0007316', 'OG0007317', 'OG0007318', 'OG0007319', 'OG0007321', 'OG0007322', 'OG0007323', 'OG0007324', 'OG0007325', 'OG0007326', 'OG0007327', 'OG0007328', 'OG0007329', 'OG0007330', 'OG0007331', 'OG0007332', 'OG0007333', 'OG0007334', 'OG0007335', 'OG0007336', 'OG0007337', 'OG0007338', 'OG0007339', 'OG0007340', 'OG0007497', 'OG0007498', 'OG0007499', 'OG0007500', 'OG0007502', 'OG0007503', 'OG0007504', 'OG0007505', 'OG0007506', 'OG0007507', 'OG0007508', 'OG0007510', 'OG0007512', 'OG0007513', 'OG0007514', 'OG0007515', 'OG0007516', 'OG0007517', 'OG0007518', 'OG0007519', 'OG0007520', 'OG0007809', 'OG0007810', 'OG0007812', 'OG0007813', 'OG0007814', 'OG0007815', 'OG0007817', 'OG0007818', 'OG0007819', 'OG0007820', 'OG0008097', 'OG0008098', 'OG0008099', 'OG0008104', 'OG0008105', 'OG0008106', 'OG0008107', 'OG0008108', 'OG0008109', 'OG0008110', 'OG0008115', 'OG0008117', 'OG0008118', 'OG0008119', 'OG0008120', 'OG0008121', 'OG0008428', 'OG0008433', 'OG0008437', 'OG0008438', 'OG0008441', 'OG0008443', 'OG0008445', 'OG0008446', 'OG0008447', 'OG0008449', 'OG0008450', 'OG0008453', 'OG0008459', 'OG0008462', 'OG0008463', 'OG0008466', 'OG0008471', 'OG0008472', 'OG0008473', 'OG0008815', 'OG0008824', 'OG0008838', 'OG0008839', 'OG0008840', 'OG0008843', 'OG0008844', 'OG0008849', 'OG0008851', 'OG0008852', 'OG0008853', 'OG0008862', 'OG0008869', 'OG0008871', 'OG0008897', 'OG0008908', 'OG0008915', 'OG0008916', 'OG0008917', 'OG0008919', 'OG0008920', 'OG0008923', 'OG0008930', 'OG0009447', 'OG0009465', 'OG0009599', 'OG0009612', 'OG0009616', 'OG0009618', 'OG0009633', 'OG0009644', 'OG0009647']

rows = []
for index, row in table.iterrows():
	if row[0] in OGs:
		rows.append(row.tolist())
	else:
		pass
# print(rows)

for row in rows:
	fname = row[0]
	row = row[1:]
	combz = zip(headers, row)
	combd = dict(combz)
	print(fname)
	# print(row)
	# print(combd)

	for key, value in combd.items():
		# print(key)
		# print(value)
		if os.path.isdir('{}'.format(fname)) == True:
			pass
		else:
			os.mkdir('{}'.format(fname))
		if isinstance(value, str) == False:
			pass
		else:
			with open('{}/{}.txt'.format(fname, key), 'w') as out:
				out.write('{}\n'.format(value.replace(', ', '\n')))
